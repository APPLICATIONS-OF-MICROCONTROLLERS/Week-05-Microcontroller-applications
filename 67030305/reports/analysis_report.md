# รายงานการวิเคราะห์: ประสิทธิภาพ Dual-Core ของ ESP32

1. บทนำ
รายงานนี้สรุปผลการวิเคราะห์ ประสิทธิภาพของ ESP32 ที่มีสถาปัตยกรรมแบบ Dual-Core โดยเน้นศึกษาการ:
กำหนดบทบาทของแต่ละคอร์ (Core Specialization)
ความหน่วงของการสื่อสารระหว่างคอร์ (Inter-core Communication Overhead)
ประสิทธิภาพการกระจายงาน (Load Balancing)

2. การกำหนดบทบาทของคอร์ (Core Specialization)
จากผลการทดลองพบว่า คอร์แต่ละตัวของ ESP32 มีลักษณะการทำงานที่เหมาะสมกับงานประเภทต่างๆ ดังนี้:
Core 0 (PRO_CPU):
เวลาเฉลี่ยต่อการทำงานแต่ละรอบ: 105 μs
เหมาะสำหรับงานที่ต้องการ การประมวลผลเร็วและความแม่นยำสูง เช่น งานที่เกี่ยวกับการควบคุมระดับต่ำ หรือการตอบสนองแบบเรียลไทม์
Core 1 (APP_CPU):
เวลาเฉลี่ยต่อการทำงานแต่ละรอบ: 9,652 μs
เหมาะสำหรับงานที่มีความซับซ้อนหรือสามารถยอมรับความหน่วงได้ เช่น งานประมวลผลข้อมูลเบื้องหลัง

3. ความหน่วงของการสื่อสารระหว่างคอร์ (Communication Overhead)
การแลกเปลี่ยนข้อมูลระหว่างคอร์มี ความหน่วงเฉลี่ยอยู่ที่ ~16,000 μs
ความหน่วงนี้อาจส่งผลลบต่อประสิทธิภาพของระบบโดยรวม หากต้องมีการสื่อสารระหว่างคอร์บ่อยๆ
แนะนำให้ ลดจำนวนครั้งในการสื่อสารข้ามคอร์ หรือนำเทคนิคอื่น เช่น Queue/Buffer Sharing เข้ามาช่วยลดผลกระทบ

4. การกระจายงานระหว่างคอร์ (Load Balancing)
ผลจากการทดลองพบว่า การกระจายโหลดระหว่างคอร์ยังไม่สมดุล ดังนี้:

Core 0:เสร็จสิ้นงานจำนวน 100 ครั้ง ภายในเวลา 4,996 msแสดงถึงความเร็วและประสิทธิภาพในการประมวลผลสูง

Core 1:เสร็จสิ้นงานจำนวน 150 ครั้ง ภายในเวลา 5,946 msถึงแม้จะประมวลผลมากกว่า แต่ใช้เวลารวมมากกว่า Core 0แสดงว่า ยังใช้ประสิทธิภาพของ Core  1 ได้ไม่เต็มที่

5. สรุป
การกำหนดบทบาทของคอร์ ควรกำหนดให้ Core 0 รับงานที่ต้องการความเร็วสูง และ Core 1 รับงานที่ซับซ้อน
ความหน่วงระหว่างคอร์ ค่อนข้างสูง (~16 ms) ควรลดการสื่อสารข้ามคอร์ให้เหลือน้อยที่สุด
การกระจายงาน ยังไม่สมดุล จำเป็นต้องปรับการแบ่งงานให้เหมาะสมกับศักยภาพแต่ละคอร์